"use strict";var e=require("react"),t=require("@virtuoso.dev/urx");function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,t}var n=/*#__PURE__*/r(e),u=["children"],o="undefined"!=typeof document?n.useLayoutEffect:n.useEffect;exports.systemToComponent=function(r,i,c){var a,s,f,l,p=Object.keys(null!=(a=i.required)?a:{}),v=Object.keys(null!=(s=i.optional)?s:{}),d=Object.keys(null!=(f=i.methods)?f:{}),b=Object.keys(null!=(l=i.events)?l:{}),y=e.createContext({});function h(e,r){void 0!==e.propsReady&&t.publish(e.propsReady,!1);for(var n=0;n<p.length;n++){var u=p[n];t.publish(e[i.required[u]],r[u])}for(var o=0;o<v.length;o++){var c=v[o];c in r&&t.publish(e[i.optional[c]],r[c])}void 0!==e.propsReady&&t.publish(e.propsReady,!0)}function O(e){return b.reduce(function(r,n){return r[n]=t.eventHandler(e[i.events[n]]),r},{})}return{Component:e.forwardRef(function(n,a){var s=n.children,f=function(e,t){if(null==e)return{};var r,n,u={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(u[r]=e[r]);return u}(n,u),l=e.useState(function(){return t.tap(t.init(r),function(e){return h(e,f)})}),m=l[0],j=e.useState(t.curry1to0(O,m))[0];return o(function(){for(var e=0;e<b.length;e++){var r=b[e];r in f&&t.subscribe(j[r],f[r])}return function(){Object.values(j).map(t.reset)}},[f,j,m]),o(function(){h(m,f)}),e.useImperativeHandle(a,t.always(function(e){return d.reduce(function(r,n){return r[n]=function(r){t.publish(e[i.methods[n]],r)},r},{})}(m))),e.createElement(y.Provider,{value:m},void 0!==c?e.createElement(c,function(e,t){for(var r={},n={},u=0,o=e.length;u<o;)n[e[u]]=1,u+=1;for(var i in t)Object.prototype.hasOwnProperty.call(n,i)||(r[i]=t[i]);return r}([].concat(p,v,b),f),s):s)}),usePublisher:function(r){return e.useCallback(t.curry2to1(t.publish,n.useContext(y)[r]),[r])},useEmitterValue:function(r){var n=e.useContext(y)[r],u=e.useState(t.curry1to0(t.getValue,n)),i=u[0],c=u[1];return o(function(){return t.subscribe(n,function(e){e!==i&&c(t.always(e))})},[n,i]),i},useEmitter:function(r,n){var u=e.useContext(y)[r];o(function(){return t.subscribe(u,n)},[n,u])}}};
//# sourceMappingURL=index.cjs.map
